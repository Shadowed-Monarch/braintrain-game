<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brain Train Hub</title>
    <style>
        :root { --bg: #000; --panel: #0a0a0a; --text: #fff; --accent: #ff0000; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); margin: 0; display: flex; flex-direction: column; align-items: center; min-height: 100vh; overflow-x: hidden; }
        
        /* Header Fix: Added padding and max-width to match the grid */
        header { width: 100%; max-width: 1100px; padding: 30px 20px; display: flex; justify-content: space-between; align-items: center; box-sizing: border-box; }
        
        .coin-display { 
            background: #111; 
            padding: 8px 18px; 
            border-radius: 12px; 
            color: #ffd700; 
            font-weight: bold; 
            border: 2px solid #ffd700; 
            display: flex; 
            align-items: center; 
            gap: 10px;
            box-shadow: 0 0 15px rgba(255,215,0,0.15);
        }
        .coin-img { width: 22px; height: 22px; }

        .settings-btn { font-size: 2rem; cursor: pointer; background: none; border: none; color: white; transition: 0.3s; display: flex; align-items: center; }
        .settings-btn:hover { transform: rotate(45deg); }

        .hero { text-align: center; padding: 40px 20px; }
        .hero h1 { font-size: 3.5rem; margin: 0; text-shadow: 0 0 20px var(--accent); letter-spacing: 4px; text-transform: uppercase; }
        .hero p { color: #888; margin-top: 10px; font-size: 1.1rem; }

        /* Games Grid */
        .games-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 30px; width: 90%; max-width: 1100px; margin: 20px 0 50px 0; }
        .game-card { background: var(--panel); border: 2px solid var(--accent); border-radius: 20px; padding: 50px 20px; text-align: center; text-decoration: none; color: white; transition: 0.3s; box-shadow: 0 10px 20px rgba(0,0,0,0.5); }
        .game-card:hover { transform: translateY(-10px); box-shadow: 0 0 30px var(--accent); background: rgba(255,255,255,0.02); }
        
        .game-icon { width: 85px; height: 85px; margin-bottom: 25px; object-fit: contain; filter: drop-shadow(0 0 8px var(--accent)); }
        .game-card h3 { font-size: 1.5rem; margin: 0; letter-spacing: 2px; }
        
        /* Shop Overlay */
        #settings-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 100; display: none; flex-direction: column; align-items: center; justify-content: center; }
        .shop-grid { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; margin: 30px; }
        .shop-item { width: 70px; height: 70px; border-radius: 50%; border: 3px solid #333; cursor: pointer; display: flex; align-items: center; justify-content: center; font-weight: bold; transition: 0.2s; position: relative; }
        .shop-item.active { border-color: #fff; transform: scale(1.1); box-shadow: 0 0 15px #fff; }
        .reset-btn { background: #1a1a1a; color: #ff4d4d; border: 1px solid #444; padding: 12px 20px; margin: 10px; cursor: pointer; border-radius: 8px; font-weight: bold; transition: 0.2s; }
        .reset-btn:hover { background: #ff4d4d; color: white; }
    </style>
</head>
<body>
    <header>
        <button class="settings-btn" onclick="toggleSettings()">⚙️</button>
        <div class="coin-display">
            <img src="https://img.icons8.com/color/48/gold-bars.png" class="coin-img" alt="Coins">
            <span id="coins">0</span>
        </div>
    </header>

    <div class="hero">
        <h1 id="main-title">BRAIN TRAIN</h1>
        <p>Speed training for your mind. Earn coins to unlock new styles.</p>
    </div>

    <div class="games-grid">
        <a href="math.html" class="game-card">
            <img src="https://img.icons8.com/ios-filled/100/ffffff/math.png" class="game-icon">
            <h3>MATH</h3>
        </a>
        <a href="grammar.html" class="game-card">
            <img src="https://img.icons8.com/ios-filled/100/ffffff/alphabet.png" class="game-icon">
            <h3>GRAMMAR</h3>
        </a>
        <a href="dots.html" class="game-card">
            <img src="https://img.icons8.com/ios-filled/100/ffffff/target.png" class="game-icon">
            <h3>DOTS</h3>
        </a>
    </div>

    <div id="settings-overlay">
        <h2 style="font-size: 2rem; letter-spacing: 2px; margin-bottom: 10px;">THEME SHOP</h2>
        <div class="shop-grid" id="shop-grid"></div>
        <div style="margin-top: 10px;">
            <button class="reset-btn" onclick="resetGame('math')">Reset Math</button>
            <button class="reset-btn" onclick="resetGame('grammar')">Reset Grammar</button>
            <button class="reset-btn" onclick="resetGame('dots')">Reset Dots</button>
        </div>
        <button onclick="toggleSettings()" style="margin-top:40px; padding:15px 60px; background:var(--accent); border:none; color:white; font-weight:bold; cursor:pointer; border-radius:30px; letter-spacing: 2px;">CLOSE</button>
    </div>

    <script>
        const colors = [
            { id: 'red', hex: '#ff0000', cost: 0 },
            { id: 'blue', hex: '#0088ff', cost: 0 },
            { id: 'yellow', hex: '#ffcc00', cost: 0 },
            { id: 'green', hex: '#00ff00', cost: 200 },
            { id: 'purple', hex: '#9900ff', cost: 200 },
            { id: 'rainbow', hex: 'rainbow', cost: 1000 }
        ];

        function migrate() {
            let bonus = 0;
            ['math', 'grammar', 'dots'].forEach(s => {
                const old = localStorage.getItem('rs_pro_v3_'+s);
                if (old && !localStorage.getItem('bt_'+s+'_max_lvl')) {
                    const lvl = parseInt(old);
                    localStorage.setItem('bt_'+s+'_max_lvl', lvl);
                    bonus += 100 + (lvl - 1) * 10 + Math.floor(lvl / 10) * 100;
                }
            });
            if (bonus > 0) {
                let c = parseInt(localStorage.getItem('bt_coins')) || 0;
                localStorage.setItem('bt_coins', c + bonus);
            }
        }
        migrate();

        let userCoins = parseInt(localStorage.getItem('bt_coins')) || 0;
        let unlocked = JSON.parse(localStorage.getItem('bt_skins')) || ['red', 'blue', 'yellow'];
        let currentSkin = localStorage.getItem('bt_current_skin') || 'red';

        function updateUI() {
            document.getElementById('coins').innerText = userCoins;
            const skin = colors.find(c => c.id === currentSkin);
            document.documentElement.style.setProperty('--accent', skin.id === 'rainbow' ? '#fff' : skin.hex);
            renderShop();
        }

        function renderShop() {
            const grid = document.getElementById('shop-grid');
            grid.innerHTML = '';
            colors.forEach(c => {
                const el = document.createElement('div');
                el.className = 'shop-item';
                if(c.id === 'rainbow') el.style.background = 'linear-gradient(45deg, red, orange, yellow, green, blue, purple)';
                else el.style.background = c.hex;
                
                if(!unlocked.includes(c.id)) {
                    el.innerHTML = `<span style="color:#000; font-size:12px;">${c.cost}</span>`;
                    el.onclick = () => {
                        if(userCoins >= c.cost) {
                            userCoins -= c.cost; unlocked.push(c.id);
                            localStorage.setItem('bt_coins', userCoins);
                            localStorage.setItem('bt_skins', JSON.stringify(unlocked));
                            updateUI();
                        } else { alert("Not enough coins!"); }
                    };
                } else {
                    if(currentSkin === c.id) el.classList.add('active');
                    el.onclick = () => { currentSkin = c.id; localStorage.setItem('bt_current_skin', c.id); updateUI(); };
                }
                grid.appendChild(el);
            });
        }

        function toggleSettings() {
            const s = document.getElementById('settings-overlay');
            s.style.display = s.style.display === 'flex' ? 'none' : 'flex';
        }

        function resetGame(s) {
            if(confirm('Reset all progress for '+s+'?')) {
                localStorage.setItem('bt_'+s+'_max_lvl', 1);
                location.reload();
            }
        }
        updateUI();
    </script>
</body>
</html>
