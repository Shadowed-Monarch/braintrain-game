<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brain Train Hub</title>
    <style>
        :root { --bg: #000; --panel: #111; --text: #fff; --accent: #ff0000; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); margin: 0; display: flex; flex-direction: column; align-items: center; min-height: 100vh; transition: background 0.5s; }
        header { width: 100%; padding: 20px; display: flex; justify-content: space-between; align-items: center; box-sizing: border-box; }
        .coin-display { background: #333; padding: 8px 15px; border-radius: 20px; color: gold; font-weight: bold; border: 1px solid gold; }
        .settings-btn { font-size: 1.5rem; cursor: pointer; background: none; border: none; color: white; }
        .hero { text-align: center; padding: 40px 20px; }
        .hero h1 { font-size: 3rem; margin: 0; text-shadow: 0 0 15px var(--accent); transition: 0.3s; }
        .games-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; width: 90%; max-width: 900px; margin-top: 20px; }
        .game-card { background: var(--panel); border: 2px solid var(--accent); border-radius: 15px; padding: 30px; text-align: center; text-decoration: none; color: white; transition: 0.3s; }
        .game-card:hover { transform: translateY(-10px); box-shadow: 0 0 20px var(--accent); }
        .game-icon { font-size: 3.5rem; margin-bottom: 10px; }
        #settings-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 100; display: none; flex-direction: column; align-items: center; justify-content: center; }
        .shop-grid { display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; margin: 20px; }
        .shop-item { width: 60px; height: 60px; border-radius: 50%; border: 3px solid #444; cursor: pointer; display: flex; align-items: center; justify-content: center; font-weight: bold; position: relative; }
        .shop-item.locked::after { content: 'üîí'; position: absolute; }
        .shop-item.active { border-color: white; transform: scale(1.1); }
        .rainbow-bg { background: linear-gradient(45deg, red, orange, yellow, green, blue, purple); background-size: 200% 200%; animation: rainbow 5s linear infinite; }
        @keyframes rainbow { 0%{background-position:0% 50%} 50%{background-position:100% 50%} 100%{background-position:0% 50%} }
        .reset-btn { background: #222; color: #ff4d4d; border: 1px solid #444; padding: 10px; margin: 5px; cursor: pointer; border-radius: 5px; }
    </style>
</head>
<body>
    <header>
        <button class="settings-btn" onclick="toggleSettings()">‚öôÔ∏è</button>
        <div class="coin-display">ü™ô <span id="coins">0</span></div>
    </header>

    <div class="hero">
        <h1 id="main-title">BRAIN TRAIN</h1>
        <p>Speed training for your mind. Earn coins to unlock new styles.</p>
    </div>

    <div class="games-grid">
        <a href="math.html" class="game-card"><div class="game-icon">‚ûó</div><h3>MATH</h3></a>
        <a href="grammar.html" class="game-card"><div class="game-icon">ABC</div><h3>GRAMMAR</h3></a>
        <a href="dots.html" class="game-card"><div class="game-icon">üîò</div><h3>DOTS</h3></a>
    </div>

    <div id="settings-overlay">
        <h2>THEME SHOP</h2>
        <div class="shop-grid" id="shop-grid"></div>
        <div style="margin-top:20px;">
            <button class="reset-btn" onclick="resetGame('math')">Reset Math</button>
            <button class="reset-btn" onclick="resetGame('grammar')">Reset Grammar</button>
            <button class="reset-btn" onclick="resetGame('dots')">Reset Dots</button>
        </div>
        <button onclick="toggleSettings()" style="margin-top:30px; padding:10px 40px; background:var(--accent); border:none; color:white; font-weight:bold; cursor:pointer;">CLOSE</button>
    </div>

    <script>
        const colors = [
            { id: 'red', hex: '#ff0000', cost: 0 },
            { id: 'blue', hex: '#0088ff', cost: 0 },
            { id: 'yellow', hex: '#ffcc00', cost: 0 },
            { id: 'green', hex: '#00ff00', cost: 200 },
            { id: 'purple', hex: '#9900ff', cost: 200 },
            { id: 'rainbow', hex: 'rainbow', cost: 1000 }
        ];

        function migrate() {
            let bonus = 0;
            ['math', 'grammar', 'dots'].forEach(s => {
                const old = localStorage.getItem('rs_pro_v3_'+s);
                if (old && !localStorage.getItem('bt_'+s+'_max_lvl')) {
                    const lvl = parseInt(old);
                    localStorage.setItem('bt_'+s+'_max_lvl', lvl);
                    bonus += 100 + (lvl - 1) * 10 + Math.floor(lvl / 10) * 100;
                }
            });
            if (bonus > 0) {
                let c = parseInt(localStorage.getItem('bt_coins')) || 0;
                localStorage.setItem('bt_coins', c + bonus);
            }
        }
        migrate();

        let userCoins = parseInt(localStorage.getItem('bt_coins')) || 0;
        let unlocked = JSON.parse(localStorage.getItem('bt_skins')) || ['red', 'blue', 'yellow'];
        let currentSkin = localStorage.getItem('bt_current_skin') || 'red';

        function updateUI() {
            document.getElementById('coins').innerText = userCoins;
            const skin = colors.find(c => c.id === currentSkin);
            document.documentElement.style.setProperty('--accent', skin.hex === 'rainbow' ? 'white' : skin.hex);
            renderShop();
        }

        function renderShop() {
            const grid = document.getElementById('shop-grid');
            grid.innerHTML = '';
            colors.forEach(c => {
                const el = document.createElement('div');
                el.className = 'shop-item' + (c.id === 'rainbow' ? ' rainbow-bg' : '');
                if(c.id !== 'rainbow') el.style.background = c.hex;
                if(!unlocked.includes(c.id)) {
                    el.classList.add('locked');
                    el.innerHTML = `<span style="color:black; font-size:10px; margin-top:20px;">${c.cost}</span>`;
                    el.onclick = () => {
                        if(userCoins >= c.cost && confirm('Buy this color?')) {
                            userCoins -= c.cost; unlocked.push(c.id);
                            localStorage.setItem('bt_coins', userCoins);
                            localStorage.setItem('bt_skins', JSON.stringify(unlocked));
                            updateUI();
                        }
                    };
                } else {
                    if(currentSkin === c.id) el.classList.add('active');
                    el.onclick = () => { currentSkin = c.id; localStorage.setItem('bt_current_skin', c.id); updateUI(); };
                }
                grid.appendChild(el);
            });
        }

        function toggleSettings() {
            const s = document.getElementById('settings-overlay');
            s.style.display = s.style.display === 'flex' ? 'none' : 'flex';
        }

        function resetGame(s) {
            if(confirm('Reset all '+s+' progress?')) {
                localStorage.setItem('bt_'+s+'_max_lvl', 1);
                location.reload();
            }
        }

        updateUI();
    </script>
</body>
</html>
